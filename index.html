<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lander Game v0.1</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #000;
            overflow: hidden;
            font-family: Arial, sans-serif;
        }
        #gameContainer {
            width: 100vw;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        #info {
            position: absolute;
            top: 10px;
            left: 10px;
            color: white;
            font-size: 14px;
            z-index: 100;
        }
    </style>
</head>
<body>
    <div id="gameContainer">
        <canvas id="gameCanvas"></canvas>
    </div>
    <div id="info">
        <div>Lander Game - Physics Demo</div>
        <div>Gravity: 9.8 m/sÂ²</div>
        <div>Press F for FPS counter</div>
    </div>

    <!-- PixiJS 8 from CDN -->
    <script src="https://cdn.jsdelivr.net/npm/pixi.js@8.10.2/dist/pixi.min.js"></script>

    <script type="module">
        let app, graphics;
        let boxes = [];
        let showFPS = false;
        let lastTime = 0;
        let fps = 0;
        let frameCount = 0;
        
        // Simple physics constants
        const GRAVITY = 0.5;
        const BOUNCE = 0.7;
        const FRICTION = 0.99;

        async function init() {
            // Create PixiJS application
            app = new PIXI.Application();
            await app.init({
                width: 800,
                height: 600,
                backgroundColor: 0x1a1a2e,
                antialias: true
            });

            document.getElementById('gameContainer').appendChild(app.canvas);

            // Create graphics container
            graphics = new PIXI.Graphics();
            app.stage.addChild(graphics);

            // Create falling boxes with simple physics
            createFallingBox(400, 100);
            createFallingBox(350, 50);
            createFallingBox(450, 30);
            
            console.log('Created', boxes.length, 'falling boxes');
            console.log('Canvas size:', app.screen.width, 'x', app.screen.height);

            // Setup input handling
            setupInput();

            // Start game loop
            app.ticker.add(gameLoop);

            console.log('Lander Game initialized - Simple physics demo ready!');
        }

        function createFallingBox(x, y) {
            boxes.push({
                x: x,
                y: y,
                vx: (Math.random() - 0.5) * 2, // Random horizontal velocity
                vy: 0, // Start with no vertical velocity
                width: 30,
                height: 30,
                rotation: 0,
                rotationSpeed: (Math.random() - 0.5) * 0.1,
                color: 0xff6b6b
            });
        }

        function setupInput() {
            window.addEventListener('keydown', (event) => {
                switch(event.code) {
                    case 'KeyF':
                        showFPS = !showFPS;
                        break;
                    case 'Space':
                        // Add a new falling box at random position
                        createFallingBox(Math.random() * 700 + 50, 50);
                        break;
                }
            });
        }

        function gameLoop(delta) {
            frameCount++;
            
            // Update simple physics for each box
            for (const box of boxes) {
                // Apply gravity
                box.vy += GRAVITY;
                
                // Apply friction to horizontal movement
                box.vx *= FRICTION;
                
                // Update position
                box.x += box.vx;
                box.y += box.vy;
                
                // Update rotation
                box.rotation += box.rotationSpeed;
                
                // Ground collision (bottom of screen)
                const groundY = app.screen.height - 50;
                if (box.y + box.height/2 > groundY) {
                    box.y = groundY - box.height/2;
                    box.vy *= -BOUNCE; // Bounce
                    box.rotationSpeed *= 0.8; // Reduce rotation on bounce
                }
                
                // Wall collisions
                if (box.x - box.width/2 < 0) {
                    box.x = box.width/2;
                    box.vx *= -BOUNCE;
                }
                if (box.x + box.width/2 > app.screen.width) {
                    box.x = app.screen.width - box.width/2;
                    box.vx *= -BOUNCE;
                }
            }

            // Clear graphics
            graphics.clear();

            // Draw ground
            graphics.beginFill(0x4a4a4a);
            graphics.drawRect(0, app.screen.height - 50, app.screen.width, 50);
            graphics.endFill();

            // Draw all boxes
            for (const box of boxes) {
                // Draw falling box
                graphics.beginFill(box.color);
                graphics.drawRect(
                    box.x - box.width/2,
                    box.y - box.height/2,
                    box.width,
                    box.height
                );
                graphics.endFill();
                
                // Draw rotation indicator (small line)
                graphics.lineStyle(2, 0xffffff);
                const lineLength = 20;
                const endX = box.x + Math.cos(box.rotation) * lineLength;
                const endY = box.y + Math.sin(box.rotation) * lineLength;
                
                graphics.moveTo(box.x, box.y);
                graphics.lineTo(endX, endY);
            }

            // FPS calculation and display
            if (showFPS) {
                const currentTime = Date.now();
                if (currentTime - lastTime >= 1000) {
                    fps = Math.round(app.ticker.FPS);
                    lastTime = currentTime;
                }
                
                // Create FPS text
                const fpsText = new PIXI.Text(`FPS: ${fps}`, {
                    fontFamily: 'Arial',
                    fontSize: 16,
                    fill: 0xffffff
                });
                fpsText.position.set(10, 80);
                app.stage.addChild(fpsText);
                
                // Remove text after this frame
                app.ticker.addOnce(() => {
                    app.stage.removeChild(fpsText);
                });
            }

            // Add instruction text
            const instructionText = new PIXI.Text('Press SPACE to add more boxes', {
                fontFamily: 'Arial',
                fontSize: 14,
                fill: 0xcccccc
            });
            instructionText.position.set(10, app.screen.height - 30);
            app.stage.addChild(instructionText);
            
            // Add debug info
            const debugText = new PIXI.Text(`Frame: ${frameCount} | Boxes: ${boxes.length}`, {
                fontFamily: 'Arial',
                fontSize: 12,
                fill: 0x00ff00
            });
            debugText.position.set(10, app.screen.height - 70);
            app.stage.addChild(debugText);
            
            app.ticker.addOnce(() => {
                app.stage.removeChild(instructionText);
                app.stage.removeChild(debugText);
            });
        }

        // Initialize the game
        init().catch(console.error);
    </script>
</body>
</html> 